<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <%- include('../../partials/head', { title: 'Editar Perfil - E-DUCA' }) %>
</head>
<body>
    <%- include('../../partials/navbar', { user: user }) %>
    
    <div class="container mt-5 pt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card shadow">
                    <div class="card-body p-5">
                        <h2 class="text-center mb-4">Editar Perfil</h2>
                        
                        <!-- Mensagens de erro -->
                        <% if (typeof erro !== 'undefined' && erro) { %>
                            <div class="alert alert-danger" role="alert">
                                <%= erro %>
                            </div>
                        <% } %>

                        <form method="POST" action="/perfil">
                            <!-- Email (somente leitura) -->
                            <div class="mb-3">
                                <label for="email" class="form-label">Email</label>
                                <input type="email" class="form-control" id="email" value="<%= user.email %>" disabled>
                                <div class="form-text">O email não pode ser alterado.</div>
                            </div>

                            <!-- Cidade e Estado -->
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="cidade" class="form-label">Cidade</label>
                                        <input type="text" class="form-control" id="cidade" name="cidade" 
                                               value="<%= user.cidade || '' %>" placeholder="Sua cidade">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="estado" class="form-label">Estado</label>
                                        <select class="form-select" id="estado" name="estado">
                                            <option value="">Selecione seu estado</option>
                                            <option value="AC" <%= user.estado === 'AC' ? 'selected' : '' %>>Acre</option>
                                            <option value="AL" <%= user.estado === 'AL' ? 'selected' : '' %>>Alagoas</option>
                                            <option value="AP" <%= user.estado === 'AP' ? 'selected' : '' %>>Amapá</option>
                                            <option value="AM" <%= user.estado === 'AM' ? 'selected' : '' %>>Amazonas</option>
                                            <option value="BA" <%= user.estado === 'BA' ? 'selected' : '' %>>Bahia</option>
                                            <option value="CE" <%= user.estado === 'CE' ? 'selected' : '' %>>Ceará</option>
                                            <option value="DF" <%= user.estado === 'DF' ? 'selected' : '' %>>Distrito Federal</option>
                                            <option value="ES" <%= user.estado === 'ES' ? 'selected' : '' %>>Espírito Santo</option>
                                            <option value="GO" <%= user.estado === 'GO' ? 'selected' : '' %>>Goiás</option>
                                            <option value="MA" <%= user.estado === 'MA' ? 'selected' : '' %>>Maranhão</option>
                                            <option value="MT" <%= user.estado === 'MT' ? 'selected' : '' %>>Mato Grosso</option>
                                            <option value="MS" <%= user.estado === 'MS' ? 'selected' : '' %>>Mato Grosso do Sul</option>
                                            <option value="MG" <%= user.estado === 'MG' ? 'selected' : '' %>>Minas Gerais</option>
                                            <option value="PA" <%= user.estado === 'PA' ? 'selected' : '' %>>Pará</option>
                                            <option value="PB" <%= user.estado === 'PB' ? 'selected' : '' %>>Paraíba</option>
                                            <option value="PR" <%= user.estado === 'PR' ? 'selected' : '' %>>Paraná</option>
                                            <option value="PE" <%= user.estado === 'PE' ? 'selected' : '' %>>Pernambuco</option>
                                            <option value="PI" <%= user.estado === 'PI' ? 'selected' : '' %>>Piauí</option>
                                            <option value="RJ" <%= user.estado === 'RJ' ? 'selected' : '' %>>Rio de Janeiro</option>
                                            <option value="RN" <%= user.estado === 'RN' ? 'selected' : '' %>>Rio Grande do Norte</option>
                                            <option value="RS" <%= user.estado === 'RS' ? 'selected' : '' %>>Rio Grande do Sul</option>
                                            <option value="RO" <%= user.estado === 'RO' ? 'selected' : '' %>>Rondônia</option>
                                            <option value="RR" <%= user.estado === 'RR' ? 'selected' : '' %>>Roraima</option>
                                            <option value="SC" <%= user.estado === 'SC' ? 'selected' : '' %>>Santa Catarina</option>
                                            <option value="SP" <%= user.estado === 'SP' ? 'selected' : '' %>>São Paulo</option>
                                            <option value="SE" <%= user.estado === 'SE' ? 'selected' : '' %>>Sergipe</option>
                                            <option value="TO" <%= user.estado === 'TO' ? 'selected' : '' %>>Tocantins</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Etapa de Interesse -->
                            <div class="mb-3">
                                <label for="etapa_preferida" class="form-label">Etapa de Interesse</label>
                                <select class="form-select" id="etapa_preferida" name="etapa_preferida">
                                    <option value="">Selecione sua etapa de interesse</option>
                                    <option value="Basico" <%= user.etapa_preferida === 'Basico' ? 'selected' : '' %>>Ensino Básico</option>
                                    <option value="Fundamental" <%= user.etapa_preferida === 'Fundamental' ? 'selected' : '' %>>Ensino Fundamental</option>
                                    <option value="Medio" <%= user.etapa_preferida === 'Medio' ? 'selected' : '' %>>Ensino Médio</option>
                                    <option value="Tecnico" <%= user.etapa_preferida === 'Tecnico' ? 'selected' : '' %>>Ensino Técnico</option>
                                    <option value="Superior" <%= user.etapa_preferida === 'Superior' ? 'selected' : '' %>>Ensino Superior</option>
                                </select>
                                <div class="form-text">Esta informação é usada para recomendações personalizadas.</div>
                            </div>

                            <!-- Botões -->
                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                <a href="/perfil" class="btn btn-secondary me-md-2">Cancelar</a>
                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-check-circle me-1"></i>Salvar Alterações
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <%- include('../../partials/footer') %>
</body>
</html>